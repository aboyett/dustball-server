<% # from https://css-tricks.com/how-to-make-a-modern-dashboard-with-nvd3-js/ %>

<div id="averageDegreesLineChart" class='with-3d-shadow with-transitions averageDegreesLineChart'>
  <svg></svg>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.2/d3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.8.6/nv.d3.js"></script>

<script>
  var PMJSON = [
  {
    key: "PM 1.0",
    values: [
  <% @samples.each do |sample| %>
     { "x": <%= sample.id %>, "y": <%= sample.pm1 %> },
   <% end %>
     ]
  },

  {
  key: "PM 2.5",
  values: [
  <% @samples.each do |sample| %>
     { "x": <%= sample.id %>, "y": <%= sample.pm25 %> },
   <% end %>
  ]
  },

  {
  key: "PM 10.0",
  values: [
  <% @samples.each do |sample| %>
     { "x": <%= sample.id %>, "y": <%= sample.pm10 %> },
   <% end %>
  ]
  }
  ];

  nv.addGraph(function () {
  var chart = nv.models.lineChart() // Initialise the lineChart object.
                                    .useInteractiveGuideline(true); // Turn on interactive guideline (tooltips)
  
  chart.xAxis.axisLabel('TimeStamp (Year)'); // Set the label of the xAxis (Vertical)
  chart.yAxis.axisLabel('Degrees (c)') // Set the label of the xAxis (Horizontal)
                    .tickFormat(d3.format('.02f')); // Rounded Numbers Format.
  
  d3.select('#averageDegreesLineChart svg') // Select the ID of the html element we defined earlier.
      .datum(PMJSON) // Pass in the JSON
      .transition().duration(500) // Set transition speed
      .call(chart); // Call & Render the chart

  nv.utils.windowResize(chart.update); // Intitiate listener for window resize so the chart responds and changes width.

  return;
  });

  
</script>
